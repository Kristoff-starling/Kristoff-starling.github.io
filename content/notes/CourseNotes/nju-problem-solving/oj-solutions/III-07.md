---
title: "问题求解 III - 07 题解"
linktitle: 'III-07 Sol'
type: docs
draft: false

math: true

menu:
    oj-solutions:
        parent: Contents
        weight: 307
---

## A. 多项式乘法模板

### 题面描述

* 给定一个 $n$ 次多项式 $A$ 和一个 $m$ 次多项式 $B$，求乘积。
* $1\leq n,m\leq 10^5$。

### 题解

可以使用 FFT，介于多项式的系数不会太大，也可以使用 NTT。

## B. 一个叫yjher的同学决定去做A*B Problem

### 题面描述

* 给定两个大整数 $a,b$，求乘积。
* $1\leq a,b\leq 10^{200000}$。

### 题解

设 $a=\overline{a_na_{n-1}\cdots a_1a_0}$，考虑生成函数 $A(x)=a_0+a_1x+\cdots+a_nx^n$​，则 $a=A(10)$，$b$ 也是同理。因此只要求两个生成函数的乘积再将 10 代入即可。

## C. 方程求解

### 题面描述

* $T$ 组数据，每次给定正整数 $n$，求四元不定方程 $ab+cd=n$ 的解的个数。
* $T\leq 10000,n\leq 5\times 10^5$。

### 题解

设 $ab=n$ 的解的个数为 $f(n)$，显然有 $f(n)=\sigma(n)$，其中 $\sigma(n)$ 表示 $n$ 的约数个数。那么原不定方程解的个数为
$$
F(n)=\sum_{i=1}^{n-1}f(i)f(n-i)
$$
该表达式是卷积形式，可以用 FFT 优化。

至于如何求 $\sigma(n)$ ，可以在线性筛素数的同时保存每个数的最小质因子，这样便可在 $O(nlogn)$ 的时间内完成 1-n 所有数的标准分解，从而确定每个数的约数个数。

总时间复杂度 $O(nlogn+T)$。

## D. 讨厌质数的人

### 题面描述

* 给定 $n$ 个数的集合，求其最大的一个子集，使得子集中的数两两之和都不是质数。
* $n\leq 3000,1\leq a_i\leq 10^5$。

### 题解

对于任意两个数，如果它们的和是质数，就在它们之间连一条边。那么该问题就转化为了求图的最大独立集。

如果不考虑 1 的参与，那么有边的两个数一定是一个奇数一个偶数，所以这个图是一个二分图。此时再考虑 1，显然最终的集合里不会有两个1，因此如果有多个 1，只保留一个参与最大独立集的计算即可。

二分图的最大独立集等于总点数减去最大匹配，用网络流求解即可。一个不太紧的时间复杂度的上界是 $O(n^{2.5})$。