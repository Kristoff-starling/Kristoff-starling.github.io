---
title: "问题求解 III - 03 题解"
linktitle: 'III-03 Sol'
type: docs
draft: false

math: true

menu:
    oj-solutions:
        parent: Contents
        weight: 303
---

## A. 拓扑排序

### 题面描述

* 给定 $n$ 个点 $m$ 条边的有向无环图，求字典序最小的拓扑序。
* $n,m\leq 10^5$。

### 题解

将所有入度为 0 的点加入小根堆，每次取堆顶元素，更新其相邻节点的入度，并将新产生的入度为 0 的点入堆即可。总时间复杂度 $O(m+nlogn)$。

## B. Acesrc Riding the Fences

### 题面描述

* 给定 $n$ 个点 $m$ 条边的无向图，保证存在欧拉路径/欧拉回路。求字典序最小的欧拉回路/路径。
* $n\leq 500,m\leq 1024$。

### 题解

基于 Fleury 算法的基本思想，给出如下的核心代码。该算法直接贪心地走尽可能小的邻边，不去详细分析某条边是否是桥，如果在有其他选择的时候走了桥，那么在回溯的时候会被自动视为最后走了桥。

```c++
void fleury(int cur)
{
    sta[++stot]=cur;
    rep(i,1,500) if (ga[cur][i])
    {
        ga[cur][i]--;ga[i][cur]--;
        fleury(i);
    }
    ans[++tot]=sta[stot--];
}
```

时间复杂度 $O(nm)$，使用邻接表存储图可以做到 $O(n+m)$。

## C. 旅行家

### 题面描述

* 给定一张 $n$ 个点 $m$ 条边的带权无向图。一条路径的代价是所有边的边权依次连接起来组成的数的大小。求 1 号节点到每个节点的代价的最小值对 $1e9+7$ 取模的结果。
* $n,m\leq 10^5,1\leq w\leq 10^9$。

### 题解

将每条边拆成位数条边，每条边的权值都是一位数，这样对这幅图做宽搜，边数最少的路径一定也是组成的数位数最小的路径。

一个困难点是如何处理权值相同的点。例如 $x$ 和 $y$ 的权值都是 123，$x$ 先出队并更新 $z$ 的权值为 1234 入队，$y$ 再出队并更新 $w$ 的权值为 1231 入队，这时队列中的单调性就被打破了。

因此我们应该将权值相同的点一并考虑，对于某种权值，对于所有满足该权值的点，从小到大枚举邻边，并将所有满足条件的相邻点打包起来放进队列。

新建的图中将有 $10m$ 级别的边，对于宽搜来说量级是可以接受的。

总时间复杂度 $O(\mid w\mid (n+m))$。