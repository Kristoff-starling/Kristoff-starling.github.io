---
title: "问题求解 IV - 02 题解"
linktitle: 'IV-02 Sol'
type: docs
draft: false

math: true

menu:
    oj-solutions:
        parent: Contents
        weight: 402
---

## A. Majority 3-SAT

### 题面描述

* 现有 $k$ 个逻辑变量 $x_1,\cdots, x_k$，给出 $n$ 个三元组 $(a_i,b_i,c_i)$，其中每个逻辑式可以取任意一个逻辑变量或其否定，每个三元组表示三个逻辑式至少两个为真，问是否能找到一种赋值法，满足所有 $n$ 个三元组。

* $k, n\leq 10^4$。

### 题解

对于一个三元组 $(a_i,b_i,c_i)$，由于至少要有两个表达式为 true，所以我们可以将其翻译成如下的一些蕴含式：如果 $a_i$ 为假，则 $b_i$ 为真；如果 $a_i$ 为假，则 $c_i$ 为真……这些逻辑式上的蕴含式最终可以转化成逻辑变量上的蕴含式，每个蕴含式形如“如果 $x_i$ 为真/假，则 $x_j$ 为真/假”。于是这个问题被转化为了一个 2-SAT 问题，以下给出 2-SAT 问题的通用解法：

我们为每个逻辑变量建立两个节点，一个表示该逻辑变量取 true，一个表示该逻辑变量取 false。这样我们可以将之前得到的所有蕴含式通过有向边表达在这张图上。我们求出这张图中所有的强连通分量，一个强连通分量中的点的意义是：只要有一个成立，则剩下的所有的都成立。因此如果一个逻辑变量的 true 节点和 false 节点在同一个强连通分量中，则原问题无解；否则我们一定能找到一种安排方案满足所有蕴含式，从而满足所有三元组的要求。

## B. 旅行问题

### 题面描述

* 给定一个 $n$ 个点的带权图，求从任意点出发，遍历所有节点至少一次并在任意点结束的最小距离。
* $n\leq 20$。

### 题解

考虑状态压缩动态规划。令 $dp(Mask, i)$ 表示当前在节点 $i$，已经经历过的点为 $Mask$ 的最小距离。转移是容易的：枚举下一个去的节点 $j$，则
$$
dp(Mask+j, j)=\min(dp(Mask\cup j,j),dp(Mask, i)+w_{ij})
$$
总时间复杂度 $O(n^2\cdot 2^n)$。

## C. 极大团

### 题面描述

* 给定 $n$ 个点 $m$ 条边的图，求图中极大团的个数。
* $n\leq 18$。

### 题解

我们枚举所有可能的点集 $S$，然后检查图中的每个节点 $v$：对于任意 $v\in S$，应当有 $S\subseteq neigh(v)$；对于任意 $v\notin S$，应当有 $S-neigh(v)\neq \emptyset$。提前预处理每个点 $v$ 的 $neigh(v)$，检查可以在线性时间内完成。

总时间复杂度 $O(n\cdot 2^n)$。

## D. 扫地机器人

### 题面描述

* 给定一个 $n\times m$ 的方格纸，求一条从 $(x,y)$ 出发，将所有格子经过恰好一次，在任意格子结束的路径。
* $n,m\leq 500$，且 $n,m$ 中至少有一个是偶数。

### 题解

下面的讨论中我们假设 $m$ 是偶数。偶数给了我们这样一个好的性质：要么 $y$ 和 $m-y$ 都是偶数，要么 $y-1$ 和 $m+1-y$ 都是偶数，因此我们可以给出一个形如这样的哈密尔顿回路构造方法：

<img src="/img/PS4.2-SweepingRobot.JPEG" alt="img" style="zoom: 33%;" />

（注：上图是 $y$ 是偶数的情况；如果 $y$ 是奇数则先向右走。）

为了代码书写的简便，我们可以先在旋转/翻转的地图上走出路径，然后再将路径逆旋转/翻转回去。这样代码量会减小很多。