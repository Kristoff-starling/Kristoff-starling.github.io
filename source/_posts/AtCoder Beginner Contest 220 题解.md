---
layout: post
date: 2021-10-02
title: "AtCoder Beginner Contest 220 题解"
categories:
tags: [AtCoder, 动态规划, 计算几何, FWT]
mathjax: true
---

## A. Find Multiple

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_a)
* 给定 $A,B,C$，在 $[A,B]$ 中寻找 $C$ 的倍数。
* $1\leq A,B,C\leq 1000$。

<!-- more -->

### 题解

从书写代码简便的角度而言，直接枚举 $[A,B]$ 之间的所有数即可。当然也可以数学计算。

## B. Base K

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_b)
* 给定 $K$ 进制下的整数 $A,B$，求 $A\times B$ 在 10 进制下的结果。
* $1\leq A,B\leq 10^5,2\leq K\leq 10$。

### 题解

将 $A,B$ 转换成十进制后相乘即可。转换进制可以使用逐位按权展开。

## C. Long Sequence

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_c)
* 给定长度为 $N$ 的序列 $A$，$B$ 是 $A$ 的无限复制版本，即将无数个 $A$ 接在一起。问从 $B$ 的第多少个数开始有前缀和大于给定的 $X$。
* $1\leq N\leq 10^5,1\leq X\leq 10^{18},1\leq A_i\leq 10^9$。

### 题解

计算出一整个 $A$ 的和，然后用 $X$ 除以该和可以定位到溢出点在第几段中，再枚举溢出点即可。总时间复杂度 $O(N)$。

## D. FG Operation

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_d)
* 给定长度为 $N$ 的序列 $A$，有两种操作：删去最左边的两个数，并在左边插入它们的和 mod 10；删去最左边的两个数，并在左边插入它们的积 mod 10。求对于每个 $0\leq k\leq 9$ ，最后剩下的数是 $k$ 的方案数。
* $N\leq 10^5,0\leq A_i\leq 9$。

### 题解

考虑动态规划。令 $dp[i][j]$ 表示当前考虑到第 $i$ 位，最左边的数字是 $j$ 的方案数。转移考虑下一次操作是乘还是加即可。总时间复杂度 $O(N)$。

## E. Distance on Large Perfect Binary Tree

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_e)
* 给定一个有 $2^n-1$ 个节点的满二叉树，再给定整数 $D$ ，问二叉树上有多少对节点之间的距离为 $D$。
* $n\leq 10^6,D\leq 2\times 10^6$。

### 题解

考虑动态规划。令 $dp[i]$ 表示有 $2^i-1$ 个节点的满二叉树中，lca 为根节点且距离为 $D$ 的节点的对数。计算 $dp[i]$ 只需在 $dp[i-1]$ 的基础上考虑那些至少有一个节点是叶子的点对即可。计算完 dp 后枚举二叉树上的每个节点，计算经过它的点对个数。总时间复杂度 $O(n)$。

## F. Distance Sums 2

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_f)
* 给定一棵 $n$ 个节点的树，标号 $1,2,...,n$ 。对于每个节点 $i$，求 $\sum_{j=1}^nd(i,j)$。
* $n\leq 2\times 10^5$。

### 题解

对于每个节点 $u$，考虑树上的每条边会被所有的最短路径经过多少次。容易发现所有在从 $u$ 到根的路径上的边会被经过 $n-size$ 次，其中 $size$ 指该边下面的子树的大小，而其他边会被经过 $size$ 次。因此我们只要先随便挑选一个节点作为根进行一次搜索，预处理每个子树的 size，再从根做一次搜索，搜索的同时修改从当前节点到根的边上的贡献并统计答案即可。

总时间复杂度 $O(n)$。

## G. Isosceles Trapezium

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_g)
* 给定平面上的 $n$ 个点，每个点有一个权值 $w$ 。现要求挑出其中的 4 个点，使其可以围成一个等腰梯形且四个顶点的权值之和最大。
* $n\leq 1000$。

### 题解

一个等腰梯形会具有以下关键性质：

* 上下两条边的垂直平分线重合
* 上下两条边的中点不重合

因此我们枚举图上的所有线段，维护线段的垂直平分线、中点和权值（两个顶点的权值和）。将垂直平分线相同的线段划成一组，在一组中寻找中点不同且权值最大的两条线段更新答案即可。

此题有一些计算几何上的处理细节。笔者采用了分数类维护线段的斜率，但事实上使用 $Ax+By+C=0$ 的形式更加好。

## H. Security Camera

### 题面描述

* [传送门](https://atcoder.jp/contests/abc220/tasks/abc220_h)
* 给定一个 $n$ 个点 $m$ 条边的图，每个点可以选或不选。问在所有的 $2^n$ 中选择点的方案中，有多少种方案可以监控到偶数条边，其中一条边被监控到当且仅当它的至少一个端点被选中。
* $n\leq 40$。

### 题解

对于一个点集能监控多少条边，一个自然的想法是累加所有点的度数，但还要扣除那些被重复计算的边，即两个端点都在点集中的边。

该数据范围容易让人想到折半搜索，我们将前 $\frac{n}{2}$ 个点分为第一组，剩下的分为第二组。令 $dp_1[Mask]$ 表示在第一组中选择了点集 $Mask$ 的情况下，所有点的度数之和（包括连向另外一组的度数）减去被重复计算的边，是奇数还是偶数。利用一些位运算技巧，该 dp 可以在 $O(2^n\cdot n)$ 的时间复杂度内完成。对于 $dp_2[Mask]$ 原理类似。但稍稍修改定义：令 $dp_2[0/1][Mask]$ 表示在第二组中选择 $Mask$，结果是奇数/偶数，有没有可能。

接下来考虑两个组的合并。令 $c[0/1][Mask]$ 表示第一组的点集在第二组中的映射为 $Mask$，且第一组中 dp 结果是奇数/偶数的方案数。其中第一组在第二组中的映射指的是第一组点集中所有点在第二组中的相邻点 Mask 全部异或的结果。这样如果在第二组中选中了 $Mask$ 中的节点，则说明第一组中有奇数个点连向了该点，在扣除两个组之间重复计算的边的时候在此处需要减去一个奇数，即会改变奇偶性。

令
$$
A[t][0]=\sum_{Mask\\& Mask'=t}\left(c[0][Mask]\cdot dp_2[0][Mask']+c[1][Mask]\cdot dp_2[1][Mask']\right)
$$

$$
A[t][1]=\sum_{Mask\\& Mask'=t}\left(c[0][Mask]\cdot dp_2[1][Mask']+c[1][Mask]\cdot dp_2[0][Mask']\right)
$$则最后只需要根据 $t$ 中 1 的个数与第二维的 0/1 来计算偶数的答案。$A$ 数组是与卷积，可以利用 FWT 优化。

总时间复杂度 $O(2^n\cdot n)$。

