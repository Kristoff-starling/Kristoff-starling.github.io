---
layout: post
date: 2022-05-15
title: "AtCoder Beginner Contest 250 题解"
categories:
tags: [AtCoder, 并查集, 贪心, 哈希, 计算几何, two-pointers, 最短路]
mathjax: true
---

## A. Adjacent Squares

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_a)
* 在一个 $H\times W$ 的方格纸上指定一个格子 $(r,c)$，求方格纸上与该格子相邻的格子个数。

<!-- more -->

### 题解

检查该方格是否贴四个边界即可。

## B. Enlarged Checker Board

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_b)
* 按照题目要求打印黑白相间的地砖。

### 题解

模拟即可。

## C. Adjacent Swaps

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_c)
* 有 $n$ 个球，第 $i$ 个上的数字是 $i$。现在有 $Q$ 次操作，每次操作会指定一个数字 $x$，我们要将写有数字 $x$ 的球和它右边的球交换位置 (如果该球是最右边的球则和它左边的球交换位置)，求最后的球的顺序。
* $n,Q\leq 2\times 10^5$。

### 题解

我们动态维护每个球的位置，这样就可以 $O(1)$ 地完成一次交换操作。总时间复杂度 $O(n+Q)$。

## D. 250-like Number

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_d)
* 一个数 $x$ 是 250-like 的当且仅当 $x=p\cdot q^3$，其中 $p<q$ 且 $p,q$ 均为质数。给定 $n$，求不超过 $n$ 的 250-like 的数的个数。
* $n\leq 10^{18}$。

### 题解

考虑枚举质数 $q$，显然 $q\leq n^{\frac{1}{3}}$。然后我们只要计算 $\min(q,\lfloor\frac{n}{q}\rfloor)$ 以内有多少质数即可，我们可以提前筛好 $n^{\frac{1}{3}}$ 以内的质数来 $O(1)$ 地完成每个 $q$ 的计算。

总时间复杂度 $O(n^{\frac{1}{3}})$。

## E. Prefix Equality

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_e)
* 给定数列 $(a_1,\cdots,a_n)$ 和 $(b_1,\cdots, b_n)$。现有 $Q$ 个询问，每个询问形如 $(x,y)$，如果 $A$ 数列的前 $x$ 个构成的集合 (即无序、去重) $S_A$ 和 $B$ 数列的前 $y$ 个构成的集合 $S_B$ 相同则输出 `Yes` ，否则输出 `No`。
* $n,Q\leq 2\times 10^5$。

### 题解

对于 $A$ 数列的第 $i$ 个数 $a_i$，记 $p_A(i)$ 为 $a_i$ 在 $B$ 中第一次出现的位置 (如果没有出现过则记为 $n+1$)。那么 $S_A\subseteq S_B$ 等价于 $\max(p_A(1),\cdots, p_A(x))\leq y$。类似地我们可以判断 $S_B\subseteq S_A$。我们可以借助哈希表线性地计算 $p_A$ 和 $p_B$ 并预处理前缀 max。

总时间复杂度 $O(n+Q)$。

## F. One Fourth

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_f)
* 给定一个平面直角坐标系中的凸 $n$ 边形，记该图形面积的 $1/4$ 为 $a$。现可以选择该图形的两个顶点作一条直线将其切成两块并从中选一块，记选的那块的面积为 $b$。求 $8|a-b|$ 的最小值。

### 题解

将图形切成两半等价于我们选择一段连续的顶点并考察这些顶点构成的多边形。我们考虑枚举左侧顶点，并向后扫直到碰到加入后第一个大于等于 $1/4$ 的右侧顶点，容易发现随着左顶点的右移动，右侧顶点也会右移，所以利用 two-pointers 技术一遍扫过去就可以考虑到所有的顶点区间的情况。

此题的难点在于融入了计算几何。我们可以通过叉积快速地计算新添加一个顶点/删去一个顶点后的面积变化 (多/少了一个三角形)。

## G. Stonks

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_g)
* 有 $n$ 天，第 $i$ 天的股票价格为 $P_i$。每天可以选择买一股，卖一股，或者什么都不做。求 $n$ 天后的最大收益。
* $n\leq 2\times 10^9$。

### 题解

这道题的一个比较明显的解法是动态规划，但朴素的动态规划时间复杂度会达到 $O(n^2)$。我们之所以希望使用动态规划，是因为当前的决策会受到后面股票价格的影响——比如当前卖出可以获得一定的收益，但如果后面有更高价格的日子那么当前卖出就亏了。

一个比较神奇的想法是：如果我们在第 $a$ 天买入，第 $b$ 天卖出，然后在第 $b$ 天买入，第 $c$ 天卖出，那么这两次买卖等价于在第 $a$ 天买入第 $c$ 天卖出。因此我们其实可以在能赚钱的时候无脑卖出，只要将当前卖出的股票再作为一个买入备选即可。

因此我们可以贪心地解决这个问题：我们用一个优先队列维护当前可以选择买入的股票，然后第 $i$ 天我们检查用可买入的最便宜的股票，然后在当天卖出能否赚到钱，只要能赚到钱就做这次操作，然后将当天的价格作为一个买入备选。此外，当天本身也可以买股票，所以还要再放一个买入备选。

总时间复杂度 $O(n\log n)$。

## Ex. Trepassing Takahashi

### 题面描述

* [传送门](https://atcoder.jp/contests/abc250/tasks/abc250_h)
* 给定一个 $n$ 个顶点 $m$ 条边的带权无向图，其中编号为 $1\cdots k$ 的顶点有屋子。现在有 $Q$ 次询问，第 $i$ 次询问给定 $x_i$, $y_i$ 和 $t_i$，问从 $x_i$ 号屋子能否走到 $y_i$ 号屋子。一个额外的限制是从一个屋子到另一个屋子途中走过的边权和不能超过 $t_i$。
* $n,m\leq 2\times 10^5$。

### 题解

对于顶点 $i$，令 $d_i$ 表示顶点 $i$ 到最近的屋子的距离，然后我们重构一张图，对于边 $(a_i,b_i)$，令 $c_i'=c_i+d_{a_i}+d_{b_i}$。我们容易发现，对于一个询问 $x_i,y_i,t_i$，给出的答案是 yes 当且仅当在重构的图中我们可以只通过边权小于等于 $t_i$ 的边从 $x_i$ 走到 $y_i$：

* 如果我们走了一条边 $c_i'>t_i$，那么我们从一个屋子出发到 $a_i$，走到 $b_i$，再走到另一个屋子，这个路程必然超出了限制。

* 如果我们通过小于等于 $t_i$ 的边走出了一条路径，设这条路径为 $p_1,\cdots, p_k$，那么考虑如下行走过程：

    > nearest house to $p_1$ --> $p_1$ --> $p_2$ --> neareset house to $p_2$ --> $p_2$ --> $p_3$ --> ......

    每四个点一组，每一组的路程恰好对应了一个 $c_i'$，所以确实存在解。

因此我们可以将询问离线，按照 $t_i$ 递增的顺序处理询问，每次将边权小于等于 $t_i$ 的边 $c_i'$ 加入图，用并查集判断连通性即可。

设 $n$ 和 $m$ 同阶，总时间复杂度 $O(n\log n)$。