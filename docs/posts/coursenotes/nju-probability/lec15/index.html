<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">
  <meta name="msvalidate.01" content="2370EBA239781ABCE950FABB5C4177B1" />

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Yuyao Wang">

  
  
  
    
  
  <meta name="description" content="$\fbox{Theorem 15.1}$ (Chebyshev) 设随机变量 $X$ 的方差存在，则有 $$ \forall \varepsilon&gt;0,P(|X-E[X]|&gt;\varepsilon)\leq \frac{D(X)}{\varepsilon^2} $$ 证明：设 $X$ 存在密度函数 $p(x)$，则 $$ \begin{align} P(|X-E[X]|&gt;\varepsilon)&amp;=\int_{{x:|X-E[X]|&gt;\varepsilon}}p(x)dx\\ &amp;\leq \int_{{x:|X-E[X]|&gt;\varepsilon}}\frac{|X-E[x]|^2}{\varepsilon^2}p(x)dx\\ &amp;\leq \frac{1}{\varepsilon^2}\int_{-\infty}^{&#43;\infty}|X-E[X]|^2p(x)dx\\ &amp;=\frac{D(X)}{\varepsilon^2}\qquad \blacksquare \end{align} $$ 我们的证明过程中使用了两次看上去很“松”的放缩，但下面的例子可以说明，在对 $X$ 没有任何额外限制的情况下，Chebyshev 的结果已经是最紧的了：">

  
  <link rel="alternate" hreflang="en-us" href="https://kristoff-starling.github.io/posts/coursenotes/nju-probability/lec15/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://kristoff-starling.github.io/posts/coursenotes/nju-probability/lec15/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Yuyao Wang&#39;s Homepage">
  <meta property="og:url" content="https://kristoff-starling.github.io/posts/coursenotes/nju-probability/lec15/">
  <meta property="og:title" content="Lecture 15: Covariance and Correlation Coefficient | Yuyao Wang&#39;s Homepage">
  <meta property="og:description" content="$\fbox{Theorem 15.1}$ (Chebyshev) 设随机变量 $X$ 的方差存在，则有 $$ \forall \varepsilon&gt;0,P(|X-E[X]|&gt;\varepsilon)\leq \frac{D(X)}{\varepsilon^2} $$ 证明：设 $X$ 存在密度函数 $p(x)$，则 $$ \begin{align} P(|X-E[X]|&gt;\varepsilon)&amp;=\int_{{x:|X-E[X]|&gt;\varepsilon}}p(x)dx\\ &amp;\leq \int_{{x:|X-E[X]|&gt;\varepsilon}}\frac{|X-E[x]|^2}{\varepsilon^2}p(x)dx\\ &amp;\leq \frac{1}{\varepsilon^2}\int_{-\infty}^{&#43;\infty}|X-E[X]|^2p(x)dx\\ &amp;=\frac{D(X)}{\varepsilon^2}\qquad \blacksquare \end{align} $$ 我们的证明过程中使用了两次看上去很“松”的放缩，但下面的例子可以说明，在对 $X$ 没有任何额外限制的情况下，Chebyshev 的结果已经是最紧的了："><meta property="og:image" content="img/map[gravatar:%!s(bool=false) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=false) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-12-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-12-13T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Lecture 15: Covariance and Correlation Coefficient | Yuyao Wang&#39;s Homepage</title>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1019ZJ28CP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1019ZJ28CP');
  </script>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Yuyao Wang&#39;s Homepage</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Yuyao Wang&#39;s Homepage</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/yuyao_CV.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/posts/coursenotes/nju-probability/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/posts/coursenotes/nju-probability/hw1/">Homework</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/posts/coursenotes/nju-probability/hw1/">Homework 1</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/hw2/">Homework 2</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/posts/coursenotes/nju-probability/lec01/">Lectures</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec01/">Lecture 01</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec02/">Lecture 02</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec03/">Lecture 03</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec04/">Lecture 04</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec05/">Lecture 05</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec06/">Lecture 06</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec07/">Lecture 07</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec08/">Lecture 08</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec09/">Lecture 09</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec10/">Lecture 10</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec11/">Lecture 11</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec12/">Lecture 12</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec13/">Lecture 13</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec14/">Lecture 14</a>
      </li>
      
      <li class="active">
        <a href="/posts/coursenotes/nju-probability/lec15/">Lecture 15</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec16/">Lecture 16</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec21/">Lecture 21</a>
      </li>
      
      <li >
        <a href="/posts/coursenotes/nju-probability/lec22/">Lecture 22</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/posts/coursenotes/nju-probability/mgf/">Materials</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/posts/coursenotes/nju-probability/mgf/">MGF</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    

    <main class="col-12 col-md-9 col-xl-9 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Lecture 15: Covariance and Correlation Coefficient</h1>

          <div class="article-style">
            <p>$\fbox{Theorem 15.1}$ (Chebyshev) 设随机变量 $X$ 的方差存在，则有
$$
\forall \varepsilon&gt;0,P(|X-E[X]|&gt;\varepsilon)\leq \frac{D(X)}{\varepsilon^2}
$$
证明：设 $X$ 存在密度函数 $p(x)$，则
$$
\begin{align}
P(|X-E[X]|&gt;\varepsilon)&amp;=\int_{{x:|X-E[X]|&gt;\varepsilon}}p(x)dx\\
&amp;\leq \int_{{x:|X-E[X]|&gt;\varepsilon}}\frac{|X-E[x]|^2}{\varepsilon^2}p(x)dx\\
&amp;\leq \frac{1}{\varepsilon^2}\int_{-\infty}^{+\infty}|X-E[X]|^2p(x)dx\\
&amp;=\frac{D(X)}{\varepsilon^2}\qquad \blacksquare
\end{align}
$$
我们的证明过程中使用了两次看上去很“松”的放缩，但下面的例子可以说明，在对 $X$ 没有任何额外限制的情况下，Chebyshev 的结果已经是最紧的了：</p>
<p>例：设 $X$ 的分布律为 $P(X=1)=P(X=-1)=\frac{1}{2k^2}$，$P(X=0)=1-\frac{1}{k^2}$，显然有 $E[X]=0$。那么
$$
P(|X-E[x]|\geq 1)=P(X=\pm 1)=\frac{1}{k^2}\leq \frac{D(X)}{\varepsilon^2}=\frac{1/k^2}{1^2}=\frac{1}{k^2}
$$
【例题】用 Chebyshev 不等式证明：如果随机变量 $X$ 满足 $D(X)=0$，则 $P(X=E[X])=1$。</p>
<blockquote>
<p>证明：令 $A={w:|X(w)-E[X]|&gt;0}$，我们要证明的目标是 $P(A)=0$。</p>
<p>令 $A_n={w:|X(w)-E[X]|&gt;\frac{1}{n}}$，那么显然有 $A=\bigcup_{n=1}^\infty A_n$，从而
$$
P(A)=P(\bigcup_{n=1}^\infty A_n)\leq \sum_{n=1}^\infty P(A_n)=\sum_{n=1}^\infty P(X-E[X]&gt;\frac{1}{n})\leq \sum_{n=1}^\infty \frac{1}{n^2}D(X)=0
$$
又 $P(A)\geq 0$，所以 $P(A)=0$。</p>
<p>（注：第一个不等号是 union bound。注意 $A_n$ 之间不是互不相交的，所以不能用“可列可加性”。）</p>
</blockquote>
<h2 id="covariance">Covariance</h2>
<p>$\fbox{Definition 15.2}$ $X,Y$ 为随机变量，$E[X],E[Y],E[XY]$ 均存在，则
$$
cov(X,Y)\triangleq E[(X-E[X])(Y-E[Y])]
$$
为 $X$ 和 $Y$ 的<strong>协方差</strong>。</p>
<p>注：(1) $cov(X,X)=D(X)$。</p>
<p>(2) $D(X\pm Y)=D(X)+D(Y)\pm 2cov(X,Y)$。</p>
<p>一般地，
$$
D(\sum_{k=1}^nX_k)=\sum_{k=1}^nD(X_k)+2\sum_{1\leq i&lt;j\leq n}cov(X_i,X_j).
$$
(3) $cov(X,Y)=E[XY-XE[Y]-YE[X]+E[X]E[Y]]=E[XY]-E[X]E[Y]$。</p>
<p>(4) $cov(X,Y)&gt;0$ 说明 $X$ 和 $Y$ 有很大倾向同时大于或小于各自的期望；$cov(X,Y)&lt;0$ 说明 $X$ 和 $Y$ 有很大倾向一个大于自身期望，一个小于自身期望。</p>
<p>(5) $cov(X,Y)$ 依赖于单位。比如如果将两者的单位本来是米，将它们改成毫米，协方差的数值将会变大很多。因此协方差不是一个很好的衡量相关性的客观数值。</p>
<p>协方差的性质：</p>
<ul>
<li>
<p>$cov(X,Y)=cov(Y,X)$。</p>
</li>
<li>
<p>对于任意 $a,b,c,d\in \mathbb R$，$cov(aX+c,bY+d)=abcov(X,Y)$。</p>
<blockquote>
<p>证明：
$$
\begin{align}
cov(aX+c,bY+d)&amp;=E[(aX+c)(bY+d)]-E[aX+c]E[bY+d]\\
&amp;=E[abXY+adX+bcY+cd]-(aE[X]+c)(bE[Y]+d)\\
&amp;=abE[XY]-abE[X]E[Y]\\
&amp;=abcov(X,Y)
\end{align}
$$</p>
</blockquote>
</li>
<li>
<p>$cov(X_1+X_2,Y)=cov(X_1,Y)+cov(X_2,Y)$。</p>
<blockquote>
<p>证明：
$$
\begin{align}
cov(X_1+X_2,Y)&amp;=E[(X_1+X_2)Y]-E[X_1+X_2]E[Y]\\
&amp;=E[X_1Y]+E[X_2Y]-E[X_1]E[Y]-E[X_2]E[Y]\\
&amp;=cov(X_1,Y)+cov(X_2,Y)
\end{align}
$$</p>
</blockquote>
</li>
<li>
<p>若 $X,Y$ 独立，则 $cov(X,Y)=0$。</p>
<blockquote>
<p>证明：$cov(X,Y)=E[XY]-E[X]E[Y]=E[X]E[Y]-E[X]E[Y]=0$。</p>
</blockquote>
</li>
</ul>
<p>下面展示一个比较精巧的计算协方差的例子：</p>
<p>【例】设 $(X,Y)$ 服从参数为 $n,p_1,p_2$ 的三项分布，即对于任意 $i,j$，$i+j\leq n$，
$$
P(X=i,Y=j)=\frac{n!}{i!j!(n-i-j)!}p_1^ip_2^j(1-p_1-p_2)^{n-i-j}
$$
考虑计算 $cov(X,Y)$。我们发现利用定义计算非常麻烦，但考虑公式
$$
D(X+Y)=D(X)+D(Y)+2cov(X,Y)
$$
这三个方差都很容易求：因为 $X\sim B(n,p_1),Y\sim B(n,p_2),X+Y\sim B(n,p_1+p_2)$，所以
$$
\begin{align}
cov(X,Y)&amp;=\frac{1}{2}(D(X+Y)-D(X)-D(Y))\\
&amp;=\frac{1}{2}(n(p_1+p_2)(1-p_1-p_2)-np_1(1-p_2)-np_2(1-p_2))\\
&amp;=-np_1p_2
\end{align}
$$
$\fbox{Theorem 15.3}$ (Cauchy-Schwarz) 设随机变量 $X,Y$ 的方差都存在，则
$$
(cov(X,Y))^2\leq D(X)D(Y)
$$
其中等号取到当且仅当存在不全为 0 的常数 $a,b$，使得 $P(Y=aX+b)=1$。</p>
<p>证明：对于任意 $t\in \mathbb R$，令
$$
u(t)=E[(t(X-E[X])-(Y-E[Y]))^2]\geq 0
$$
那么
$$
\begin{align}
u(t)&amp;=t^2E[(X-E[X])^2]-2tE[(X-E[X])(Y-E[Y])]+E[(Y-E[Y])^2]\\
&amp;=t^2D(X)-2tcov(X,Y)+D(Y)
\end{align}
$$
因为 $u(t)\geq 0$，所以二次函数判别式小于等于 0，即 $(cov(X,Y))^2\leq D(X)D(Y)$。</p>
<p>下面考虑等号成立的条件：</p>
<p>$\Rightarrow:$ 若 $(cov(X,Y))^2=D(X)D(Y)$，那么存在 $t_0\in \mathbb R$，$u(t_0)=0$。令 $Z=t_0(X-E[X])-(Y-E[Y])$，则
$$
0=u(t_0)=E[Z^2]\geq D(Z)\geq 0
$$
所以 $D(Z)=0$，$P(Z=E[Z])=P(Z=0)=1$。</p>
<p>$\Leftarrow:$ 若存在不全为 0 的 $a,b\in \mathbb R$ 满足 $P(Y=aX+b)=1$，那么
$$
\begin{align}
cov(X,Y)&amp;=E[XY]-E[X]E[Y]\\
&amp;=E[X(aX+b)]-E[X]E[aX+b]\\
&amp;=aE[X^2]+bE[X]-a(E[X])^2-bE[X]\\
&amp;=aD(X)=\pm \sqrt{a^2D(X)^2}
\end{align}
$$
注意到 $D(Y)=D(aX+b)=a^2D(X)$，所以 $cov(X,Y)=\pm \sqrt{D(X)D(Y)}$。$\blacksquare$</p>
<h2 id="correlation-coefficient">Correlation Coefficient</h2>
<p>由 Cauchy-Schwarz 不等式可知，$D(X),D(Y)&gt;0$ 时，$\left|\frac{cov(X,Y)}{\sqrt{D(X)D(Y)}}\right|\leq 1$，我们在此基础上定义相关系数。</p>
<p>$\fbox{Definition 15.4}$ 设随机变量 $X,Y$ 方差均存在，$D(X)&gt;0,D(Y)&gt;0$，则令
$$
\rho_{XY}\triangleq \frac{cov(X,Y)}{\sqrt{D(X)D(Y)}}
$$
为 $X,Y$ 的<strong>相关系数</strong>，也可记作 $corr(X,Y)$。若 $\rho_{XY}&gt;0$，则称 $X,Y$ 正相关；若 $\rho_{XY}&lt;0$，则称 $X,Y$ 负相关。</p>
<p>注：(1) 考虑 $X,Y$ 的标准化随机变量 $X^*=\frac{X-E[X]}{\sqrt{D(X)}},Y^*=\frac{Y-E[Y]}{\sqrt{D(Y)}}$，那么
$$
cov(X^*,Y^*)=E[(X^*-E[X^*])(Y^*-E[Y^*])]=E\left[\frac{X-E[X]}{\sqrt{D(X)}}\cdot \frac{Y-E[Y]}{\sqrt{D(Y)}}\right]=\frac{cov(X,Y)}{\sqrt{D(X)D(Y)}}=\rho_{XY}
$$
即标准化后的随机变量的协方差等于其原变量的相关系数。</p>
<p>(2) $\rho_{XY}$ 不依赖 $X,Y$ 数量级的选取。</p>
<p>(3) 根据 Cauchy-Schwarz 的取等条件，$|\rho_{XY}=1|$ 当且仅当 $|cov(X,Y)|=\sqrt{D(X)D(Y)}$，即存在不全为 0 的常数 $a,b$，$P(Y=aX+b)=1$。$\rho_{XY}$ 刻画了 $X,Y$ 之间线性相关的程度，$|\rho_{XY}|$ 越大，$X,Y$ 的线性关系就越密切。</p>
<p>$\fbox{Definition 15.5}$ 若 $X,Y$ 满足 $\rho_{XY}=0$，则称 $X,Y$ <strong>线性无关</strong>或<strong>不相关</strong>。</p>
<p>$\fbox{Proposition 15.6}$ 在 $X,Y$ 方差存在的情况下，下述 4 条等价：</p>
<ul>
<li>$\rho_{XY}=0$。</li>
<li>$cov(X,Y)=0$。</li>
<li>$E[XY]=E[X]E[Y]$。</li>
<li>$D(X\pm Y)=D(X)+D(Y)$。</li>
</ul>
<p>根据上述命题，我们容易发现如果 $X,Y$ 相互独立，那么 $\rho_{XY}=0$，但反之不成立，即不相关是比相互独立弱的条件，下面是一个例子：</p>
<p>【例】设 $\theta$ 服从 $[0,2\pi]$ 上的均匀分布，令 $X=\cos \theta,Y=\cos (\theta+a)$，其中 $a$ 为给定常数，考虑 $\rho_{XY}$。
$$
\begin{align}
E[X]&amp;=\int_0^{2\pi}xp(x)dx=\frac{1}{2\pi}\int_0^{2\pi}\cos xdx=0\\
E[Y]&amp;=\frac{1}{2\pi}\int_0^{2\pi}\cos(x+a)dx=0\\
D(X)&amp;=E[(X-0)^2]=\frac{1}{2\pi}\int_0^{2\pi}\cos ^2xdx=\frac{1}{4\pi}\int_0^{2\pi}(1+\cos 2x)dx=\frac{1}{2}\\
D(Y)&amp;=E[(Y-0)^2]=\frac{1}{2\pi}\int_0^{2\pi}\cos ^2(x+a)dx=\frac{1}{4\pi}\int_0^{2\pi}(1+\cos 2(x+a))dx=\frac{1}{2}\\
E[XY]&amp;=E[\cos \theta \cos (\theta +a)]=\frac{1}{2\pi}\int_0^{2\pi}\cos x\cos (x+a)dx\\
&amp;\overset{和差化积}{=}\frac{1}{4\pi}(\int_0^{2\pi}\cos(2x+a)+\cos a)dx=\frac{1}{2}\cos a\\
\rho_{XY}&amp;=\frac{cov(X,Y)}{\sqrt{D(X)D(Y)}}=\frac{\frac{1}{2}cos a}{\sqrt{\frac{1}{2}\cdot \frac{1}{2}}}=\cos a
\end{align}
$$
当 $a=\frac{3\pi}{2}$ 时，$\rho_{XY}=0$，$X,Y$ 不相关。此时 $X=\cos \theta,Y=\cos (\theta+a)=\sin \theta$，有 $X^2+Y^2=1$。</p>
<p>考虑如下事件的概率：$P(|X|\leq \frac{1}{2},|Y|\leq \frac{1}{2})$，因为 $X^2+Y^2=1$，所以该概率为 0。但 $P(|X|\leq \frac{1}{2})&gt;0$，$P(|Y|\leq \frac{1}{2})&gt;0$，从而 $P(|X|\leq \frac{1}{2},|Y|\leq \frac{1}{2})\neq P(|X|\leq \frac{1}{2})\cdot P(|Y|\leq \frac{1}{2})$，所以 $X,Y$ 不相互独立。</p>
<p>【例题】设 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，求 $cov(X,Y)$ 和 $\rho_{XY}$。</p>
<p>解：
$$
p(x,y)=\frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}e^{-\frac{1}{2(1-\rho^2)}\left[\left(\frac{x-\mu_1}{\sigma_1}\right)^2-2\rho \left(\frac{x-\mu_1}{\sigma_1}\cdot \frac{y-\mu_2}{\sigma_2}\right)+\left(\frac{y-\mu_2}{\sigma_2}\right)^2\right]}
$$
我们已知 $E[X]=\mu_1,E[Y]=\mu_2,D(X)=\sigma_1^2,D(Y)=\sigma_2^2$。
$$
\begin{align}
cov(X,Y)&amp;=E[(X-E[X])(Y-E[Y])]=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}(x-\mu_1)(y-\mu_2)p(x,y)dxdy\\
&amp;\overset{u=\frac{x-\mu_1}{\sigma_1},v=\frac{y-\mu_2}{\sigma_2}}{=}\frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}\sigma_1u\cdot \sigma_2ve^{-\frac{1}{2(1-\rho^2)}(u^2-2\rho uv+v^2)}d(\sigma_1u)d(\sigma_2v)\\
&amp;=\frac{\sigma_1\sigma_2}{2\pi\sqrt{1-\rho^2}}\int_{-\infty}^{+\infty}v\int_{-\infty}^{+\infty}ue^{-\frac{1}{2(1-\rho^2)}(u^2-2\rho vu+\rho^2v^2-\rho^2v^2+v^2)}dudv\\
&amp;=\frac{\sigma_1\sigma_2}{2\pi\sqrt{1-\rho^2}}\int_{-\infty}^{+\infty}ve^{-\frac{v^2}{2}}\int_{-\infty}^{+\infty}ue^{-\frac{1}{2(1-\rho^2)}(u-\rho v)^2}dudv
\end{align}
$$
注意到
$$
\frac{1}{\sqrt{2\pi}\sqrt{1-\rho^2}}\int_{-\infty}^{+\infty}ue^{-\frac{1}{2(1-\rho^2)}(u-\rho v)^2}du
$$
是正态分布 $N(\rho v, 1-\rho^2)$ 的期望 (自变量为 $u$)，所以
$$
\begin{align}
cov(X,Y)=\frac{\sigma_1\sigma_2}{\sqrt{2\pi}}\int_{-\infty}^{+\infty}ve^{-\frac{v^2}{2}}\rho vdv=\sigma_1\sigma_2\rho\cdot  \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty}v^2e^{-\frac{v^2}{2}}dv
\end{align}
$$
注意到
$$
\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty}v^2e^{-\frac{v^2}{2}}dv=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty}(v-0)^2e^{-\frac{v^2}{2}}dv
$$
是标准正态分布 $N(0,1)$ 的方差，所以该式为 1，所以 $cov(X,Y)=\sigma_1\sigma_2\rho$。相关系数 $\rho_{XY}=\rho$。</p>
<p>$\fbox{Theorem 15.7}$ 设 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，则 $X,Y$ 相互独立当且仅当 $X,Y$ 不相关。</p>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/posts/coursenotes/nju-probability/lec14/" rel="next">Lecture 14: Variance</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/posts/coursenotes/nju-probability/lec16/" rel="prev"> Lecture 16: Moment and Covariance Matrix</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Dec 13, 2020</p>

          




          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    <span id="busuanzi_container_site_pv">
        Total Visit: <span id="busuanzi_value_site_pv"></span>
    </span>

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.f8eb5cb10262ef4a670903a5cb3e03ae.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
